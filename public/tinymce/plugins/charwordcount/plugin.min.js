tinymce.PluginManager.add("charwordcount",
function(b) {
    function f() {
        b.theme.panel.find("#wordcount").text(["Words: {0}, Characters: {1}", c.getCount(), c.getCountCharacters()])
    }
    var c = this,
    d, e;
    d = b.getParam("wordcount_countregex", /[\w\u2019\x27\-]+/g);
    e = b.getParam("wordcount_cleanregex", /[0-9.(),;:!?%#$?\x27\x22_+=\\\/\-]*/g);
    b.on("init",
    function() {
        var a = b.theme.panel && b.theme.panel.find("#statusbar")[0];
        a && window.setTimeout(function() {
            a.insert({
                type: "label",
                name: "wordcount",
                text: ["Words: {0}, Characters: {1}", c.getCount(), c.getCountCharacters()],
                classes: "wordcount"
            },
            0);
            b.on("setcontent beforeaddundo keyup", f)
        },
        0)
    });
    c.getCount = function() {
        var a = b.getContent({
            format: "raw"
        }),
        c = 0;
        a && (a = a.replace(/\.\.\./g, " "), a = a.replace(/<.[^<>]*?>/g, " ").replace(/&nbsp;|&#160;/gi, " "), a = a.replace(/(\w+)(&.+?;)+(\w+)/, "$1$3").replace(/&.+?;/g, " "), a = a.replace(e, ""), a = a.match(d)) && (c = a.length);
        return c
    };
    c.getCountCharacters = function() {
        return ! 0 == b.settings.charwordcount_include_tags ? b.getContent({
            format: "raw"
        }).length: b.getContent({
            format: "raw"
        }).replace(/<.[^<>]*?>/g, "").replace(/&[^;]+;/g, "?").length
    }
});
